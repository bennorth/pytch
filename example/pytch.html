<html>
  <head>
    <script src="../dist/skulpt.min.js" type="text/javascript"></script>
    <script src="../dist/skulpt-stdlib.js" type="text/javascript"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"> </script>
    <style>
      #shown-variables { background-color: #e0e0e0; padding: 8px 0px; width: 480px; }
      #shown-variables .shown-variable { padding: 4px; }
      #shown-variables .shown-variable .name { padding-right: 4px; }
      #shown-variables .shown-variable .value { padding-left: 4px; }
    </style>
  </head>

  <body>
    <table id="thread-monitor" style="float:right">
      <thead><tr><th>Event</th><th>N.live</th><th>N.waiting</th><th>N.sleeping</th></tr></thead>
      <tbody></tbody>
    </table>
    <canvas id="pytch-canvas" width="480" height="360" style="background-color:green"></canvas>
<textarea id="code" rows="24" cols="80" style="display:none">
</textarea>
<div id="green-flag" style="height: 32px; width: 48px; background-color: green; margin: 16px;"></div>
<p id="shown-variables"></p>
<p id="frame-idx"></p>
<pre id="skulpt-stdout"></pre>
    <script>
      function append_stdout(text) {
          var elt = document.getElementById("skulpt-stdout");
          elt.innerHTML = elt.innerHTML + text;
      }

      function builtinRead(x) {
          if (Sk.builtinFiles === undefined || Sk.builtinFiles["files"][x] === undefined)
	      throw "File not found: '" + x + "'";
          return Sk.builtinFiles["files"][x];
      }

      Sk.configure({ read: builtinRead, output: append_stdout });

      // To be able to load the Python asynchronously, you'll need to:
      //
      //  - Run a local HTTP server:
      //        python3 -m http.server 8123
      //    will do this.
      //
      //  - Symlink the 'dist' files:
      //        cd $PROJECT_ROOT/example
      //        ln -s ../dist
      //    will do this.
      //
      $("#code").load("make-a-chase-game.py", function() {
          var prog = document.getElementById("code").value;
          var p = Sk.misceval.asyncToPromise(function() {
              return Sk.importMainWithBody("<stdin>", false, prog, true);
          });
      });
    </script>
  </body>
</html>
